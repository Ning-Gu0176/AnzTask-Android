

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>iOS Codebase Overview &mdash; Black Label Solutions iOS 1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Black Label Solutions iOS 1.0 documentation" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> Black Label Solutions iOS</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="package_content.html">What’s in package</a></li>
<li class="toctree-l2"><a class="reference internal" href="task_requirement.html">Task Requirement</a></li>
<li class="toctree-l2"><a class="reference internal" href="problem_analize.html">Problem Analize</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_docs.html">API docs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../coding/index.html">Coding</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../coding/coding_conventions.html">Coding Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coding/identified_issues.html">Identified Codebase Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coding/third_party_libraries.html">Third Party Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coding/building_running_configuring.html">Building , Running and App Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coding/deployment.html">Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coding/l10n_i18n.html">L10n and i18n</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../testing/testing_team.html">Testing Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/testing_plans.html">Testing Plans</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/unit_testing.html">Unit Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/testing_simulator.html">Testing on the simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/testing_devices.html">Testing on a payment device</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/automated_testing.html">Automated Testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#how-do-i-create-a-new-ios-project-for-a-new-client">How do I create a new iOS project for a new client?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#do-i-need-a-payment-device-to-test">Do I need a payment device to test?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#how-do-we-send-builds-to-qa">How do we send builds to QA?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#how-do-we-build-sign-and-send-builds-to-clients">How do we build, sign and send builds to clients?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#how-do-we-build-sign-and-send-the-nomadpos-app-to-the-itunes-store">How do we build, sign and send the NomadPOS app to the iTunes store?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#what-are-some-of-the-largest-issues-right-now">What are some of the largest issues right now</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#what-are-some-of-the-projects-lined-up-to-tackle-these-issues">What are some of the projects lined up to tackle these issues</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../howto/index.html">How-to guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../howto/vpn_mach_osx.html">How to connect to MACH using Open VPN on OSX</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Black Label Solutions iOS</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>iOS Codebase Overview</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/intro/ios_codebase_overview.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="ios-codebase-overview">
<h1>iOS Codebase Overview<a class="headerlink" href="#ios-codebase-overview" title="Permalink to this headline">¶</a></h1>
<p>This page will give a brief overview of the codebase as a whole, the architecture used for core and custom functionality and a high level overview of some of the challenge the code base faces in its current form.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This documentation assumes that you wil be familiar with Black Label Solutions tech stack architecture at a high level, as well as the devices and technology involved with their POS solutions. Please talk to (Val) Valentin Causevski or Paul van&#8217;t Klooster for an overview.</p>
</div>
<div class="section" id="the-codebase-according-to-xcode">
<h2>The codebase according to Xcode<a class="headerlink" href="#the-codebase-according-to-xcode" title="Permalink to this headline">¶</a></h2>
<p>The iOS codebase consists of a single workspace with a project for each application.</p>
<a class="reference internal image-reference" href="_static/img/xcode-projects.png"><img alt="_static/img/xcode-projects.png" class="align-center" src="_static/img/xcode-projects.png" style="width: 400px;" /></a>
<p></p><div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>The workspace name <cite>intellectual_property</cite> came about because Black Label Solutions previously used to inherit client apps to work on and their needed to be a way to separate Black Label&#8217;s code and IP from their clients. This should be re-named now as that type of work is not done anymore.</li>
<li>Projects with <strong>POS</strong> in their title indicate that the app is a <cite>POS</cite> application used by a company staff member.</li>
<li>The <strong>nomaditunesPOSIOS</strong> project is the one exception to the above rule as it is Black Label&#8217;s consumer POS solution.</li>
<li>The <cite>dormant</cite> and <cite>live</cite> groups indicate the current status of a project but these can change. For example, some retailers like Foodworks only use their application once a year while others like the Reject Shop consumer app have been developed but never launched.</li>
</ul>
</div>
</div>
<div class="section" id="the-codebase-according-to-the-file-system">
<h2>The codebase according to the file system<a class="headerlink" href="#the-codebase-according-to-the-file-system" title="Permalink to this headline">¶</a></h2>
<p>Xcode&#8217;s ability to group (structure) the code differently to how it&#8217;s organized in the file system is used heavily in this workspace.</p>
<a class="reference internal image-reference" href="_static/img/filesystem-structure.png"><img alt="_static/img/filesystem-structure.png" class="align-center" src="_static/img/filesystem-structure.png" style="width: 400px;" /></a>
<p>The <cite>optional</cite>, <cite>required</cite> and <cite>shared</cite> directories contain code that each project points to that effectively are 99% of the files used to build an application.</p>
</div>
<div class="section" id="how-code-is-shared-and-re-used">
<h2>How code is shared and re-used<a class="headerlink" href="#how-code-is-shared-and-re-used" title="Permalink to this headline">¶</a></h2>
<p>The current strategy for code sharing and re-use is to have a single set of source files that all applications will use. This goes beyond being just an &#8220;engine&#8221; for a project, it means this code essentially IS each project.</p>
<p>The below shows where code will be in the Xcode project and where it will point to on the file system. This structure is identical for all projects.</p>
<a class="reference internal image-reference" href="_static/img/project-filesystem.png"><img alt="_static/img/project-filesystem.png" class="align-center" src="_static/img/project-filesystem.png" style="width: 400px;" /></a>
<p>In order for projects to have custom features, functionality, text and UI tweaks, the AppDelegate and a constants file is used.</p>
<a class="reference internal image-reference" href="_static/img/event-cinemas.png"><img alt="_static/img/event-cinemas.png" class="align-center" src="_static/img/event-cinemas.png" style="width: 100%;" /></a>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This architecture means that changing a core file (e.g. a model) in any project is actually changing that file for EVERY project.</p>
</div>
<p>The consequences of this are good (immediate consistency) and perhaps not good, depending upon the implications for changing functionality at the top level of a hierarchy where regressions may be caused in projects that have not been updated in some time.</p>
</div>
<div class="section" id="project-appdelegate-as-master-and-commander">
<h2>Project AppDelegate as master and commander<a class="headerlink" href="#project-appdelegate-as-master-and-commander" title="Permalink to this headline">¶</a></h2>
<p>Each project has an AppDelegate which effectively acts as the captain of the ship and the rest of the codebase act as crew members. View Controllers for example will call the AppDelegate for configuration based calls such as what colour the total currency text should be, as well as an event handler for when products are added to a transaction.</p>
<p>The merits of this system were greater when the code base was smaller but as it has grown to a large size, this approach is now experiencing some tough issues:</p>
<blockquote>
<div><ul class="simple">
<li>AppDelegate is used for something it&#8217;s not intended to (its the point for the OS to call into the application)</li>
<li>The mixing of configuration calls and business logic calls needs to be split out.</li>
<li>View Controllers and Views are not extendable, only configurable from the AppDelegate. This is not a problem now as the UI is standardized between clients but will make it difficult to handle UI customization requests as time progresses.</li>
<li>Difficult to know exactly what functionality has been customized by a Project only by looking at the AppDelegate. You must know object is delegating to the AppDelegate in order for each overridden method call.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="towards-a-new-architecture">
<h2>Towards a new architecture?<a class="headerlink" href="#towards-a-new-architecture" title="Permalink to this headline">¶</a></h2>
<p>Moving the core BLS files into their own project so that each specific project could consume a framework, static library or linked binary should be investigated.</p>
<p>This would enable releases of the BLS core to be controlled for each client and enable unit tests to be written against this project specifically.</p>
<p>It would also speed up compilation time for projects as the number of files for compiling would in most cases drop to the AppDelegate and the configuration files.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Reused code (shared, optional, required) can be taken out and put into two separated projects: NomadCodebaseFramework(“required” folder) and NomadHardwareFramework (“optional” folder). The “shared” folder (just two class) could be merged into NomadCodebaseFramework. Then these two projects can be distributed as frameworks and shared across team.</li>
<li>The app delegation file should be cleaned. All theme related and hardware related code should be moved to another delegation file(s): AppSkinConfigurationDelegation for theming and AppHardwareConfigurationDelegation for included hardware resources.</li>
<li>Property list is recommended for skin configuration and hardware configuration since it’s more obvious and much easier to customise for different brand.</li>
<li>Recommend to use xib files for each UI page.</li>
<li>Unchanged resources like strings (localised as well), images and xib files should be put into framework project.</li>
</ul>
</div>
</div>
</div>


          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Black Label Solutions Pty Ltd.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>